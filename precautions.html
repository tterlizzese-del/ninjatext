<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Precautions — NinjaText</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <header class="topnav">
      <div class="nav-inner">
        <a class="nav-brand" href="index.html">NinjaText | Precautions</a>
        <nav class="nav-links">
          <a href="index.html">Home</a>
          <a href="instructions.html">Instructions</a>
          <a href="precautions.html">Precautions</a>
          <a href="tools.html">Tools</a>
          <a href="about.html">About</a>
        </nav>
      </div>
    </header>

  <main class="page precautions">
      <div class="columns">
        <div class="column">
          <div class="section">
            <form id="general-form">

              <strong>General</strong>

<input class="instruction" type="checkbox" name="instruction" value="worsening or severe pain">worsening or severe pain<br>

<input class="instruction" type="checkbox" name="instruction" value="sudden worsening of your symptoms or feeling much sicker than before">sudden worsening <br>

<input class="instruction" type="checkbox" name="instruction" value="fatigue/weakness">fatigue/weakness <br>

<input class="instruction" type="checkbox" name="instruction" value="new or severe pain that does not improve with the pain medications we recommended">pain that does not improve w/ meds <br>


<input class="instruction" type="checkbox" name="instruction" value="any new symptom that is severe, persistent, or concerning to you">anything new or concerning <br>

<input class="instruction" type="checkbox" name="instruction" value="new or worsening trouble breathing, chest pain, or fainting">chest pain, dyspnea, syncope <br>

<input class="instruction" type="checkbox" name="instruction" value="unintentional weight-loss">unintentional weight-loss <br> 

<input class="instruction" type="checkbox" name="instruction" value="Excessive thirst and urination with weight loss or fatigue (concerning for diabetes)">polyuria/ polydypsia/ fatigue <br> 

            </form>
          </div>

          <div class="section">
            <form id="infectious-form">

              <strong>Infectious / Immune</strong>

<input class="instruction" type="checkbox" name="instruction" value="fever ≥100.4ºF or chills">Fever ≥100.4ºF or chills<br>

<input class="instruction" type="checkbox" name="instruction" value="drainage of pus from a wound">drainage of pus from a wound <br>

<input class="instruction" type="checkbox" name="instruction" value="facial swelling or swelling of lips/tongue associated with rash (possible allergic reaction)">angioedema <br>

<input class="instruction" type="checkbox" name="instruction" value="new wheezing or feeling like your airway is closing">wheezing/stridor <br>

            </form>
          </div>

          <div class="section">
            <form id="cardiac-form">
              <strong>Cardiac</strong>

<input class="instruction" type="checkbox" name="instruction" value="chest pain">chest pain<br>

<input class="instruction" type="checkbox" name="instruction" value="chest pain especially with activities/ exertion or pain that radiates">chest pain with activities <br>

<input class="instruction" type="checkbox" name="instruction" value="passing out or syncope">syncope <br>

<input class="instruction" type="checkbox" name="instruction" value="palpitations with dizziness or fainting">palpitations <br>

<input class="instruction" type="checkbox" name="instruction" value="new or worsening leg swelling, especially if one-sided or with shortness of breath">new or worsening leg swelling <br>

            </form>
          </div>

          <div class="section">
            <form id="pulmonary-form">
              <strong>Pulmonary</strong>

<input class="instruction" type="checkbox" name="instruction" value="shortness of breath">shortness of breath<br>

<input class="instruction" type="checkbox" name="instruction" value="pulse oxygen &lt;92%">low pulse Ox<br>

<input class="instruction" type="checkbox" name="instruction" value="pain with breathing">pain with breathing <br>

<input class="instruction" type="checkbox" name="instruction" value="wheezing not relieved by your inhaler">wheezing <br>

<input class="instruction" type="checkbox" name="instruction" value="coughing up blood">coughing up blood <br>


            </form>
          </div>
        </div>

        <div class="column">
          <div class="section">
            <form id="neuro-form">
              <strong>Neuro</strong>

<input class="instruction" type="checkbox" name="instruction" value="new/ worsening weakness">new weakness<br>

<input class="instruction" type="checkbox" name="instruction" value="new numbness or tingling in face/arms/legs">new numbness or tingling<br>

<input class="instruction" type="checkbox" name="instruction" value="new blurry or double vision">new blurry or double vision <br>

<input class="instruction" type="checkbox" name="instruction" value="new speech changes/slurred speech">new speech changes <br>

<input class="instruction" type="checkbox" name="instruction" value="changes in coordination or trouble walking">coordination/gait changes <br>

<input class="instruction" type="checkbox" name="instruction" value="confusion or trouble speaking/understanding">confusion <br>

<input class="instruction" type="checkbox" name="instruction" value="sudden severe headache ('worst headache of my life')">severe headache <br>

<input class="instruction" type="checkbox" name="instruction" value="new seizures or seizures different from baseline">new seizures <br>

<input class="instruction" type="checkbox" name="instruction" value="neck stiffness especially with fever">neck stiffness <br>

            </form>
          </div>

          <div class="section">
            <form id="gi-form">
              <strong>GI</strong>

<input class="instruction" type="checkbox" name="instruction" value="vomiting">vomiting<br>

<input class="instruction" type="checkbox" name="instruction" value="unable to keep food down due to vomiting even after taking nausea medicine">vomiting after nausea meds<br>

<input class="instruction" type="checkbox" name="instruction" value="vomiting blood or dark brown (coffee ground appearing) vomit">vomiting blood/dark brown vomit <br>

<input class="instruction" type="checkbox" name="instruction" value="bloody or black stools">bloody or black stools <br>

<input class="instruction" type="checkbox" name="instruction" value="jaundice or new yellowing of skin/eyes">jaundice <br>

            </form>
          </div>

          <div class="section">
            <form id="gu-renal-form">
              <strong>GU / Renal</strong>

<input class="instruction" type="checkbox" name="instruction" value="pain or burning with peeing">pain or burning with peeing<br>

<input class="instruction" type="checkbox" name="instruction" value="blood in the urine">blood in the urine<br>

<input class="instruction" type="checkbox" name="instruction" value="back/flank pain">back/flank pain<br>

<input class="instruction" type="checkbox" name="instruction" value="inability to urinate or very low urine output
">enuresis<br>

            </form>
          </div>

          <div class="section">
            <form id="skin-form">
              <strong>Skin</strong>

<input class="instruction" type="checkbox" name="instruction" value="rapidly spreading redness, swelling, or pain around a wound or rash">worsening rash<br>

<input class="instruction" type="checkbox" name="instruction" value="new redness or swelling of a wound">new redness / swelling of wound<br>


<input class="instruction" type="checkbox" name="instruction" value="widespread rash with fever, blistering, or peeling skin">rash w/ fever, blisters, peeling<br>

<input class="instruction" type="checkbox" name="instruction" value="severe itching or hives not improving with antihistamines and associated with breathing or swallowing issues">worsening urticaria<br>

            </form>
          </div>
        </div>

        <div class="column">
          <div class="section">
            <form id="male-gu-form">
              <strong>Male GU</strong>

<input class="instruction" type="checkbox" name="instruction" value="drainage or discharge from the penis">discharge from penis<br>

<input class="instruction" type="checkbox" name="instruction" value="new lesions/sores on the penis">new lesions/sores on the penis<br>

<input class="instruction" type="checkbox" name="instruction" value="scrotal pain or swelling or severe testicle pain">scrotal pain or swelling<br>

            </form>
          </div>

          <div class="section">
            <form id="female-gu-form">
              <strong>Female GU</strong>

<input class="instruction" type="checkbox" name="instruction" value="vaginal bleeding or more than 2 pads per hour">vaginal bleeding &gt;2 pads per hour<br>

<input class="instruction" type="checkbox" name="instruction" value="drainage of smelly or discolored fluid from the vagina">drainage from the vagina<br>

<input class="instruction" type="checkbox" name="instruction" value="worsening or severe pelvic pain">worsening or severe pelvic pain<br>

            </form>
          </div>

          <div class="section">
            <form id="msk-form">
              <strong>MSK</strong>

<input class="instruction" type="checkbox" name="instruction" value="worsening joint pain">worsening joint pain<br>

<input class="instruction" type="checkbox" name="instruction" value="joint swelling or redness">joint swelling or redness <br>

<input class="instruction" type="checkbox" name="instruction" value="an open wound or uncontrolled bleeding">open wound or bleeding <br>

<input class="instruction" type="checkbox" name="instruction" value="new trouble feeling or moving your fingers or hands, or cold/pale fingers">ischemic UE <br>

<input class="instruction" type="checkbox" name="instruction" value="new trouble feeling or moving your toes/feet, or cold/pale toes">ischemic LE<br>

<input class="instruction" type="checkbox" name="instruction" value="pain so bad you cannot bear weight or walk">pain w/ ambulation <br>

            </form>
          </div>

          <div class="section">
            <form id="ent-form">
              <strong>ENT</strong>

<input class="instruction" type="checkbox" name="instruction" value="difficulty breathing or high-pitched-noisy breathing (stridor)">stridor<br>

<input class="instruction" type="checkbox" name="instruction" value="inability to swallow saliva or severe throat pain with drooling">odynophagia <br>

<input class="instruction" type="checkbox" name="instruction" value="changes in how your voice sounds or muffling of your voice">changes in phonation <br>

<input class="instruction" type="checkbox" name="instruction" value="sudden hearing loss">hearing loss <br>

<input class="instruction" type="checkbox" name="instruction" value="ear pain with fever">ear pain w/ fever <br>

<input class="instruction" type="checkbox" name="instruction" value="drainage of pus/ fluid/ or blood from the ears">ear drainage <br>

<input class="instruction" type="checkbox" name="instruction" value="severe nosebleeds that don't stop with pressure">severe epistaxis <br>

            </form>
          </div>
        </div>

        <div class="column">
          <div class="section">
            <form id="ophtho-form">
              <strong>Ophtho</strong>

<input class="instruction" type="checkbox" name="instruction" value="sudden vision loss or new blurry vision">vision changes<br>

<input class="instruction" type="checkbox" name="instruction" value="new or worsening eye pain that does not resolve with the medications we prescribed">eye pain <br>

<input class="instruction" type="checkbox" name="instruction" value="new flashes of light, floaters, or a curtain/shadow over your vision">visual curtain <br>

<input class="instruction" type="checkbox" name="instruction" value="drainage of pus from or around the eye">purulent drainage <br>

<input class="instruction" type="checkbox" name="instruction" value="painful eye movements">pain with EOMs <br>

            </form>
          </div>

          <div class="section">
            <form id="psych-form">
              <strong>Psych</strong>
<input class="instruction" type="checkbox" name="instruction" value="suicidal thoughts or plans">SI<br>

<input class="instruction" type="checkbox" name="instruction" value="homicidal thoughts or intent to harm others">HI <br>

<input class="instruction" type="checkbox" name="instruction" value="new or worsening hallucinations or psychosis">psychosis <br>

<input class="instruction" type="checkbox" name="instruction" value="inability to care for self (not eating/drinking, wandering)">trouble w/ ADLs <br>

            </form>
          </div>

          <div class="section">
            <form id="peds-form">
              <strong>Peds</strong>
<input class="instruction" type="checkbox" name="instruction" value="acting much more sleepy or lethargic than normal">lethargy<br>

<input class="instruction" type="checkbox" name="instruction" value="difficulty breathing: rapid breathing, retractions (sucking in between ribs), nasal flaring, or grunting">respiratory distress <br>

<input class="instruction" type="checkbox" name="instruction" value="acting much more fussy than normal or inconsolable">fussy/inconsolable <br>

<input class="instruction" type="checkbox" name="instruction" value="eating/pooping/ or peeing less than normal (&lt;4 wet diapers in 24 hours)">diet or BM changes <br>

<input class="instruction" type="checkbox" name="instruction" value="refusing to feed or drink, or signs of dehydration (very few wet diapers, no tears when crying, dry mouth)">dehydration <br>

<input class="instruction" type="checkbox" name="instruction" value="persistent vomiting or diarrhea with inability to keep fluids down">vomiting/diarrhea <br>

<input class="instruction" type="checkbox" name="instruction" value="high fever: Any fever ≥100.4°F (38°C) in infants &lt;2 months">high fever <br>

<input class="instruction" type="checkbox" name="instruction" value="new or worsening rash, especially purple spots/bruising (petechiae) not explained by injury">rash/petechiae <br>

            </form>
          </div>
        </div>
      </div>

      <!-- Bottom actions: aggregated label + copy/clear buttons (same behavior as instructions page) -->
      <div class="actions" aria-hidden="false">
        <div class="actions-inner">
          <div id="selected-label" class="instruction-label" aria-live="polite">No items selected.</div>
          <div class="action-buttons">
            <button id="copy-selected-btn" class="copy-btn" type="button">Copy</button>
            <button id="clear-selected-btn" class="clear-btn" type="button">Clear selection</button>
            <button id="edit-prec-prefix-btn" class="launch-btn" style="padding:6px 10px;">Edit prefix text</button>
            <button id="reset-prec-prefix-btn" class="launch-btn" style="padding:6px 10px;background:#444;">Reset prefix</button>
          </div>
        </div>
      </div>

      <script>
        (function(){
          function decodeHtml(html){
            var txt = document.createElement('textarea');
            txt.innerHTML = html;
            return txt.value;
          }

          function stripHtmlToText(html){
            var withSpaces = html.replace(/<br\s*\/?\s*>/gi, ' ');
            var tmp = document.createElement('div');
            tmp.innerHTML = withSpaces;
            return tmp.textContent || tmp.innerText || '';
          }

          function inputsForPage(){
            return Array.from(document.querySelectorAll('input.instruction'));
          }

          var label = document.getElementById('selected-label');
          var copyBtn = document.getElementById('copy-selected-btn');
          var clearBtn = document.getElementById('clear-selected-btn');

          var PREC_PREFIX_KEY = 'ninjatext_precautions_prefix_v1';
          var PREC_DEFAULT_PREFIX = 'Your evaluation was reassuring that you are not having an emergency at this time, but symptoms can change. Please be on the lookout for the following symptoms and return to the ER as needed:';
          function readPrecPrefix(){ return localStorage.getItem(PREC_PREFIX_KEY) || PREC_DEFAULT_PREFIX; }

          function updateLabel(){
            var inputs = inputsForPage();
            var checked = inputs.filter(function(i){ return i.checked; });
            var prefix = window.__ninja_prec_prefix || readPrecPrefix();
            if(!checked.length){ label.textContent = prefix + ' ' + 'No items selected.'; return; }
            var parts = checked.map(function(i){ var decoded = decodeHtml(i.value || ''); return stripHtmlToText(decoded).trim(); }).filter(Boolean);
            // Prefix followed immediately by the items (append inline, no newlines)
            label.textContent = prefix + ' ' + parts.join(' ');
          }

          document.addEventListener('change', function(e){ if(e.target && e.target.matches && e.target.matches('input.instruction')) updateLabel(); });
          updateLabel();

          copyBtn.addEventListener('click', function(){
            var text = label.textContent || '';
            if(!text) return;
            if(navigator.clipboard && navigator.clipboard.writeText){
              navigator.clipboard.writeText(text).then(function(){ copyBtn.textContent = 'Copied!'; setTimeout(function(){ copyBtn.textContent = 'Copy'; },2000); }, function(){ fallbackCopy(text); });
            } else { fallbackCopy(text); }

            function fallbackCopy(t){ var ta = document.createElement('textarea'); ta.value = t; document.body.appendChild(ta); ta.select(); try{ document.execCommand('copy'); copyBtn.textContent = 'Copied!'; setTimeout(function(){ copyBtn.textContent = 'Copy'; },2000); }catch(e){ alert('Copy failed'); } document.body.removeChild(ta); }
          });

          clearBtn.addEventListener('click', function(){ var inputs = inputsForPage(); inputs.forEach(function(i){ i.checked = false; }); updateLabel(); clearBtn.textContent = 'Cleared'; setTimeout(function(){ clearBtn.textContent = 'Clear selection'; },1200); });
        })();
          // Wire edit/reset buttons for Precautions
          (function(){
            var editBtn = document.getElementById('edit-prec-prefix-btn');
            var resetBtn = document.getElementById('reset-prec-prefix-btn');
            if(!editBtn || !resetBtn) return;
            editBtn.addEventListener('click', function(){ var cur = readPrecPrefix(); var next = prompt('Edit the prefix text for Precautions (saved in this browser):', cur); if(next!==null){ localStorage.setItem(PREC_PREFIX_KEY, next); updateLabel(); editBtn.textContent='Saved'; setTimeout(()=>editBtn.textContent='Edit prefix text',1200); }});
            resetBtn.addEventListener('click', function(){ if(!confirm('Reset prefix to default?')) return; localStorage.setItem(PREC_PREFIX_KEY, PREC_DEFAULT_PREFIX); updateLabel(); resetBtn.textContent='Reset'; setTimeout(()=>resetBtn.textContent='Reset prefix',1200); });
          })();
      </script>
      <script>
        // Prefix editor for Precautions page (separate block to avoid colliding with main logic)
        (function(){
          var EDIT_KEY = 'ninjatext_precautions_prefix_v1';
          var defaultPrefix = 'Your evaluation was reassuring that you are not having an emergency at this time, but symptoms can change. Please be on the lookout for the following symptoms and return to the ER as needed:';
          var editBtn = document.getElementById('edit-prec-prefix-btn');
          var resetBtn = document.getElementById('reset-prec-prefix-btn');
          function read(){ return localStorage.getItem(EDIT_KEY) || defaultPrefix; }
          function write(v){ localStorage.setItem(EDIT_KEY, v); }

          // If updateLabel exists, wrap it so it uses stored prefix when available
          if(window.updateLabel && typeof window.updateLabel === 'function'){
            var orig = window.updateLabel;
            window.updateLabel = function(){
              var stored = read();
              // expose temporary override for main script to pick up
              window.__ninja_prec_prefix = stored;
              try{ orig(); }finally{ delete window.__ninja_prec_prefix; }
            };
            // call once to initialize with stored prefix
            window.updateLabel();
          } else {
            // No global updateLabel available — provide a fallback that updates the label directly
            var label = document.getElementById('selected-label');
            function applyStoredPrefix(){
              var cur = label.textContent || '';
              var stored = read();
              if(cur.indexOf(':')>-1){
                // naive replace: prefix before first ':'
                var rest = cur.substring(cur.indexOf(':')+1).trim();
                label.textContent = stored + ' ' + rest;
              } else {
                label.textContent = stored + ' ' + cur;
              }
            }
            applyStoredPrefix();
          }

          editBtn.addEventListener('click', function(){ var cur = read(); var next = prompt('Edit the prefix text for Precautions (saved in this browser):', cur); if(next!==null){ write(next); if(window.updateLabel) window.updateLabel(); editBtn.textContent='Saved'; setTimeout(()=>editBtn.textContent='Edit prefix text',1200); }});
          resetBtn.addEventListener('click', function(){ if(!confirm('Reset prefix to default?')) return; write(defaultPrefix); if(window.updateLabel) window.updateLabel(); resetBtn.textContent='Reset'; setTimeout(()=>resetBtn.textContent='Reset prefix',1200); });
        })();
      </script>
    </main>
  </body>
</html>
